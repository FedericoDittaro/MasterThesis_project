Training set: 1797 immagini
Validation set: 385 immagini
Test set: 386 immagini
Conteggio pixel per classe: 100%|██████████████████████████████████████████████████| 1797/1797 [00:06<00:00, 262.60it/s]

✅ Classi uniche trovate nel training set: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]
📊 Pixel per classe:
Classe  0:      42200
Classe  1:  115363613
Classe  2:     245824
Classe  3:       5186
Classe  4:        814
Classe  5:     118857
Classe  6:      72255
Classe  7:      13434
Classe  8:       5310
Classe  9:     197877
Classe 10:     249757
Classe 11:     296875
Classe 12:     181268
Classe 13:      91103
Classe 14:     390110
Classe 15:     217388
Classe 16:       6870
Classe 17:      21528
Classe 18:     247923

⚖️ Pesi calcolati per CrossEntropyLoss (log balanced):
Classe  0: Peso = 7.934412
Classe  1: Peso = 0.703515
Classe  2: Peso = 6.173943
Classe  3: Peso = 10.030555
Classe  4: Peso = 11.882275
Classe  5: Peso = 6.899561
Classe  6: Peso = 7.396885
Classe  7: Peso = 9.078799
Classe  8: Peso = 10.006927
Classe  9: Peso = 6.390507
Classe 10: Peso = 6.158104
Classe 11: Peso = 5.985680
Classe 12: Peso = 6.478035
Classe 13: Peso = 7.165256
Classe 14: Peso = 5.713352
Classe 15: Peso = 6.296634
Classe 16: Peso = 9.749368
Classe 17: Peso = 8.607302
Classe 18: Peso = 6.165458

Epoch 1/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:33<00:00,  1.64s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.45s/it]

Train Loss: 1.2775 | Val Loss: 1.0416
Global -> IoU: 0.0575 | F1: 0.0520 | Precision: 0.0514 | Recall: 0.0526
✅ Model saved.

Epoch 2/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.4628 | Val Loss: 1.1814
Global -> IoU: 0.0575 | F1: 0.0520 | Precision: 0.0514 | Recall: 0.0526
No improvement.

Epoch 3/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.3825 | Val Loss: 1.2898
Global -> IoU: 0.0575 | F1: 0.0520 | Precision: 0.0514 | Recall: 0.0526
No improvement.

Epoch 4/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.3225 | Val Loss: 1.3401
Global -> IoU: 0.0611 | F1: 0.0571 | Precision: 0.0664 | Recall: 0.0557
No improvement.

Epoch 5/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.2831 | Val Loss: 1.3574
Global -> IoU: 0.0630 | F1: 0.0625 | Precision: 0.1392 | Recall: 0.0586
No improvement.

Epoch 6/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.2583 | Val Loss: 1.1607
Global -> IoU: 0.0589 | F1: 0.0554 | Precision: 0.1553 | Recall: 0.0544
No improvement.

Epoch 7/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.45s/it]

Train Loss: 0.2318 | Val Loss: 0.9101
Global -> IoU: 0.0748 | F1: 0.0775 | Precision: 0.2223 | Recall: 0.0670
✅ Model saved.

Epoch 8/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.2386 | Val Loss: 0.6376
Global -> IoU: 0.1039 | F1: 0.1330 | Precision: 0.2953 | Recall: 0.1104
✅ Model saved.

Epoch 9/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.2251 | Val Loss: 0.4331
Global -> IoU: 0.1458 | F1: 0.2066 | Precision: 0.3391 | Recall: 0.1764
✅ Model saved.

Epoch 10/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.62s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.1931 | Val Loss: 0.2807
Global -> IoU: 0.2226 | F1: 0.2951 | Precision: 0.3417 | Recall: 0.3039
✅ Model saved.

Epoch 11/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.1774 | Val Loss: 0.2594
Global -> IoU: 0.2590 | F1: 0.3513 | Precision: 0.3831 | Recall: 0.3469
✅ Model saved.

Epoch 12/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.1843 | Val Loss: 0.2875
Global -> IoU: 0.2676 | F1: 0.3440 | Precision: 0.3817 | Recall: 0.3427
No improvement.

Epoch 13/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.1712 | Val Loss: 0.2499
Global -> IoU: 0.2609 | F1: 0.3187 | Precision: 0.3814 | Recall: 0.3384
✅ Model saved.

Epoch 14/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.1608 | Val Loss: 0.2134
Global -> IoU: 0.2650 | F1: 0.3372 | Precision: 0.3460 | Recall: 0.3904
✅ Model saved.

Epoch 15/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.1628 | Val Loss: 0.1869
Global -> IoU: 0.3029 | F1: 0.3739 | Precision: 0.3713 | Recall: 0.4247
✅ Model saved.

Epoch 16/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.1451 | Val Loss: 0.1680
Global -> IoU: 0.3341 | F1: 0.4254 | Precision: 0.4331 | Recall: 0.4697
✅ Model saved.

Epoch 17/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.1367 | Val Loss: 0.1768
Global -> IoU: 0.3398 | F1: 0.4177 | Precision: 0.4340 | Recall: 0.4634
No improvement.

Epoch 18/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.62s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.1299 | Val Loss: 0.1895
Global -> IoU: 0.3179 | F1: 0.3894 | Precision: 0.4090 | Recall: 0.4253
No improvement.

Epoch 19/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.62s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.1388 | Val Loss: 0.1757
Global -> IoU: 0.3446 | F1: 0.4346 | Precision: 0.4343 | Recall: 0.4772
No improvement.

Epoch 20/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.1202 | Val Loss: 0.1395
Global -> IoU: 0.3640 | F1: 0.4532 | Precision: 0.4203 | Recall: 0.5229
✅ Model saved.

Epoch 21/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.62s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.1182 | Val Loss: 0.1722
Global -> IoU: 0.3681 | F1: 0.4549 | Precision: 0.4309 | Recall: 0.5132
No improvement.

Epoch 22/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.62s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.1185 | Val Loss: 0.1780
Global -> IoU: 0.3348 | F1: 0.4447 | Precision: 0.4121 | Recall: 0.5093
No improvement.

Epoch 23/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.62s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.1119 | Val Loss: 0.1464
Global -> IoU: 0.3754 | F1: 0.4627 | Precision: 0.4441 | Recall: 0.5213
No improvement.

Epoch 24/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.1332 | Val Loss: 0.1947
Global -> IoU: 0.3106 | F1: 0.4326 | Precision: 0.4015 | Recall: 0.4901
No improvement.

Epoch 25/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.1115 | Val Loss: 0.1393
Global -> IoU: 0.3578 | F1: 0.4803 | Precision: 0.4564 | Recall: 0.5308
✅ Model saved.

Epoch 26/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.1084 | Val Loss: 0.1732
Global -> IoU: 0.3468 | F1: 0.4589 | Precision: 0.4361 | Recall: 0.5235
No improvement.

Epoch 27/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.62s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.0956 | Val Loss: 0.1863
Global -> IoU: 0.3308 | F1: 0.4650 | Precision: 0.4528 | Recall: 0.5128
No improvement.

Epoch 28/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.43s/it]

Train Loss: 0.1020 | Val Loss: 0.1294
Global -> IoU: 0.3933 | F1: 0.5039 | Precision: 0.4783 | Recall: 0.5568
✅ Model saved.

Epoch 29/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.0873 | Val Loss: 0.1148
Global -> IoU: 0.3776 | F1: 0.4975 | Precision: 0.4481 | Recall: 0.5796
✅ Model saved.

Epoch 30/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.45s/it]

Train Loss: 0.0899 | Val Loss: 0.1085
Global -> IoU: 0.3807 | F1: 0.5094 | Precision: 0.4648 | Recall: 0.5845
✅ Model saved.

Epoch 31/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.45s/it]

Train Loss: 0.0764 | Val Loss: 0.1259
Global -> IoU: 0.3895 | F1: 0.5171 | Precision: 0.4819 | Recall: 0.5725
No improvement.

Epoch 32/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.0768 | Val Loss: 0.1268
Global -> IoU: 0.3938 | F1: 0.5105 | Precision: 0.4804 | Recall: 0.5630
No improvement.

Epoch 33/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.43s/it]

Train Loss: 0.0649 | Val Loss: 0.0984
Global -> IoU: 0.4323 | F1: 0.5422 | Precision: 0.5037 | Recall: 0.6010
✅ Model saved.

Epoch 34/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.0630 | Val Loss: 0.1034
Global -> IoU: 0.3864 | F1: 0.5373 | Precision: 0.5085 | Recall: 0.6074
No improvement.

Epoch 35/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.62s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.0644 | Val Loss: 0.1128
Global -> IoU: 0.3985 | F1: 0.5366 | Precision: 0.5127 | Recall: 0.5946
No improvement.

Epoch 36/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.0779 | Val Loss: 0.1311
Global -> IoU: 0.3621 | F1: 0.5075 | Precision: 0.4846 | Recall: 0.5640
No improvement.

Epoch 37/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.0710 | Val Loss: 0.2595
Global -> IoU: 0.3378 | F1: 0.4946 | Precision: 0.4804 | Recall: 0.5325
No improvement.

Epoch 38/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.45s/it]

Train Loss: 0.0641 | Val Loss: 0.1062
Global -> IoU: 0.4097 | F1: 0.5493 | Precision: 0.5124 | Recall: 0.6323
No improvement.

Epoch 39/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.0679 | Val Loss: 0.1178
Global -> IoU: 0.3822 | F1: 0.5297 | Precision: 0.4899 | Recall: 0.6263
No improvement.

Epoch 40/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.45s/it]

Train Loss: 0.0893 | Val Loss: 0.1259
Global -> IoU: 0.3782 | F1: 0.5146 | Precision: 0.4785 | Recall: 0.5800
No improvement.

Epoch 41/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.0821 | Val Loss: 0.1260
Global -> IoU: 0.3852 | F1: 0.5088 | Precision: 0.4592 | Recall: 0.5878
No improvement.

Epoch 42/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.45s/it]

Train Loss: 0.0842 | Val Loss: 0.1601
Global -> IoU: 0.3378 | F1: 0.4911 | Precision: 0.4787 | Recall: 0.5258
No improvement.

Epoch 43/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.0720 | Val Loss: 0.1024
Global -> IoU: 0.3884 | F1: 0.5196 | Precision: 0.4883 | Recall: 0.5864
No improvement.

Epoch 44/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.62s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.45s/it]

Train Loss: 0.0615 | Val Loss: 0.0962
Global -> IoU: 0.3997 | F1: 0.5421 | Precision: 0.5055 | Recall: 0.6132
✅ Model saved.

Epoch 45/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.0739 | Val Loss: 0.3139
Global -> IoU: 0.2742 | F1: 0.4087 | Precision: 0.4124 | Recall: 0.4953
No improvement.

Epoch 46/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.1034 | Val Loss: 0.1578
Global -> IoU: 0.3084 | F1: 0.4508 | Precision: 0.4352 | Recall: 0.5619
No improvement.

Epoch 47/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.0773 | Val Loss: 0.1307
Global -> IoU: 0.3836 | F1: 0.5180 | Precision: 0.4797 | Recall: 0.5878
No improvement.

Epoch 48/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.0685 | Val Loss: 0.1250
Global -> IoU: 0.3829 | F1: 0.5313 | Precision: 0.5054 | Recall: 0.5926
No improvement.

Epoch 49/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.0644 | Val Loss: 0.1053
Global -> IoU: 0.4125 | F1: 0.5453 | Precision: 0.5037 | Recall: 0.6242
No improvement.

Epoch 50/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:32<00:00,  1.63s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.44s/it]

Train Loss: 0.0666 | Val Loss: 0.1065
Global -> IoU: 0.3975 | F1: 0.5514 | Precision: 0.5134 | Recall: 0.6179
No improvement.
