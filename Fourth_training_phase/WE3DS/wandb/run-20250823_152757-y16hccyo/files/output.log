Training set: 1797 immagini
Validation set: 385 immagini
Test set: 386 immagini
Conteggio pixel per classe: 100%|██████████████████████████████████████████████████| 1797/1797 [00:06<00:00, 263.22it/s]

✅ Classi uniche trovate nel training set: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]
📊 Pixel per classe:
Classe  0:      42200
Classe  1:  115363613
Classe  2:     245824
Classe  3:       5186
Classe  4:        814
Classe  5:     118857
Classe  6:      72255
Classe  7:      13434
Classe  8:       5310
Classe  9:     197877
Classe 10:     249757
Classe 11:     296875
Classe 12:     181268
Classe 13:      91103
Classe 14:     390110
Classe 15:     217388
Classe 16:       6870
Classe 17:      21528
Classe 18:     247923

⚖️ Pesi calcolati per CrossEntropyLoss (log balanced):
Classe  0: Peso = 7.934412
Classe  1: Peso = 0.703515
Classe  2: Peso = 6.173943
Classe  3: Peso = 10.030555
Classe  4: Peso = 11.882275
Classe  5: Peso = 6.899561
Classe  6: Peso = 7.396885
Classe  7: Peso = 9.078799
Classe  8: Peso = 10.006927
Classe  9: Peso = 6.390507
Classe 10: Peso = 6.158104
Classe 11: Peso = 5.985680
Classe 12: Peso = 6.478035
Classe 13: Peso = 7.165256
Classe 14: Peso = 5.713352
Classe 15: Peso = 6.296634
Classe 16: Peso = 9.749368
Classe 17: Peso = 8.607302
Classe 18: Peso = 6.165458

Epoch 1/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:35<00:00,  3.30s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 1.7233 | Val Loss: 0.9547
Global -> IoU: 0.0553 | F1: 0.0542 | Precision: 0.0819 | Recall: 0.0537
✅ Model saved.

Epoch 2/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.5634 | Val Loss: 1.1550
Global -> IoU: 0.0575 | F1: 0.0520 | Precision: 0.0514 | Recall: 0.0526
No improvement.

Epoch 3/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.3951 | Val Loss: 1.1775
Global -> IoU: 0.0575 | F1: 0.0520 | Precision: 0.0514 | Recall: 0.0526
No improvement.

Epoch 4/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.26s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.3379 | Val Loss: 1.3280
Global -> IoU: 0.0575 | F1: 0.0520 | Precision: 0.0514 | Recall: 0.0526
No improvement.

Epoch 5/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.3231 | Val Loss: 1.2918
Global -> IoU: 0.0633 | F1: 0.0629 | Precision: 0.0609 | Recall: 0.0654
No improvement.

Epoch 6/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.2702 | Val Loss: 1.2950
Global -> IoU: 0.0633 | F1: 0.0630 | Precision: 0.0821 | Recall: 0.0593
No improvement.

Epoch 7/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.75s/it]

Train Loss: 0.2628 | Val Loss: 1.4992
Global -> IoU: 0.0608 | F1: 0.0583 | Precision: 0.0885 | Recall: 0.0560
No improvement.

Epoch 8/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.2375 | Val Loss: 1.4126
Global -> IoU: 0.0602 | F1: 0.0574 | Precision: 0.0952 | Recall: 0.0555
No improvement.

Epoch 9/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.2157 | Val Loss: 1.5891
Global -> IoU: 0.0603 | F1: 0.0569 | Precision: 0.0546 | Recall: 0.0648
No improvement.

Epoch 10/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.1997 | Val Loss: 1.3490
Global -> IoU: 0.0670 | F1: 0.0681 | Precision: 0.1329 | Recall: 0.0624
No improvement.

Epoch 11/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.26s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.75s/it]

Train Loss: 0.1890 | Val Loss: 1.2276
Global -> IoU: 0.0702 | F1: 0.0717 | Precision: 0.2203 | Recall: 0.0652
No improvement.

Epoch 12/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.73s/it]

Train Loss: 0.1864 | Val Loss: 1.0823
Global -> IoU: 0.0723 | F1: 0.0771 | Precision: 0.3028 | Recall: 0.0678
No improvement.

Epoch 13/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.26s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.73s/it]

Train Loss: 0.1563 | Val Loss: 1.0860
Global -> IoU: 0.0654 | F1: 0.0658 | Precision: 0.3088 | Recall: 0.0602
No improvement.

Epoch 14/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.1441 | Val Loss: 0.8868
Global -> IoU: 0.0937 | F1: 0.1054 | Precision: 0.3117 | Recall: 0.0843
✅ Model saved.

Epoch 15/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.73s/it]

Train Loss: 0.1357 | Val Loss: 0.6859
Global -> IoU: 0.1246 | F1: 0.1425 | Precision: 0.3591 | Recall: 0.1210
✅ Model saved.

Epoch 16/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.1325 | Val Loss: 0.5029
Global -> IoU: 0.1872 | F1: 0.2192 | Precision: 0.4329 | Recall: 0.1754
✅ Model saved.

Epoch 17/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.73s/it]

Train Loss: 0.1200 | Val Loss: 0.7127
Global -> IoU: 0.1420 | F1: 0.1687 | Precision: 0.4070 | Recall: 0.1273
No improvement.

Epoch 18/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.26s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.1284 | Val Loss: 0.3237
Global -> IoU: 0.2893 | F1: 0.3501 | Precision: 0.4110 | Recall: 0.3731
✅ Model saved.

Epoch 19/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.1267 | Val Loss: 0.4390
Global -> IoU: 0.3231 | F1: 0.3750 | Precision: 0.4583 | Recall: 0.3617
No improvement.

Epoch 20/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.26s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.1266 | Val Loss: 0.3447
Global -> IoU: 0.3250 | F1: 0.3870 | Precision: 0.4667 | Recall: 0.3683
No improvement.

Epoch 21/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.26s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.1740 | Val Loss: 0.2686
Global -> IoU: 0.2707 | F1: 0.3395 | Precision: 0.3847 | Recall: 0.3613
✅ Model saved.

Epoch 22/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.28s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.1333 | Val Loss: 0.2494
Global -> IoU: 0.3404 | F1: 0.3963 | Precision: 0.4623 | Recall: 0.3699
✅ Model saved.

Epoch 23/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.1440 | Val Loss: 0.1874
Global -> IoU: 0.3877 | F1: 0.4518 | Precision: 0.4525 | Recall: 0.4653
✅ Model saved.

Epoch 24/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.1163 | Val Loss: 0.2161
Global -> IoU: 0.3652 | F1: 0.4365 | Precision: 0.4444 | Recall: 0.4666
No improvement.

Epoch 25/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.26s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.73s/it]

Train Loss: 0.1164 | Val Loss: 0.4955
Global -> IoU: 0.2320 | F1: 0.3132 | Precision: 0.3947 | Recall: 0.3105
No improvement.

Epoch 26/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.26s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.73s/it]

Train Loss: 0.1299 | Val Loss: 0.1700
Global -> IoU: 0.3700 | F1: 0.4330 | Precision: 0.4314 | Recall: 0.4706
✅ Model saved.

Epoch 27/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.1470 | Val Loss: 0.2502
Global -> IoU: 0.3450 | F1: 0.4035 | Precision: 0.4094 | Recall: 0.4343
No improvement.

Epoch 28/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.1127 | Val Loss: 0.1269
Global -> IoU: 0.3983 | F1: 0.4770 | Precision: 0.4444 | Recall: 0.5301
✅ Model saved.

Epoch 29/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.73s/it]

Train Loss: 0.1169 | Val Loss: 0.1343
Global -> IoU: 0.4265 | F1: 0.5027 | Precision: 0.5074 | Recall: 0.5248
No improvement.

Epoch 30/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.1395 | Val Loss: 0.1925
Global -> IoU: 0.3673 | F1: 0.4394 | Precision: 0.4554 | Recall: 0.4452
No improvement.

Epoch 31/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.73s/it]

Train Loss: 0.1019 | Val Loss: 0.1232
Global -> IoU: 0.4228 | F1: 0.4915 | Precision: 0.4787 | Recall: 0.5334
✅ Model saved.

Epoch 32/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.0954 | Val Loss: 0.1311
Global -> IoU: 0.4300 | F1: 0.4966 | Precision: 0.4832 | Recall: 0.5215
No improvement.

Epoch 33/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.0885 | Val Loss: 0.1046
Global -> IoU: 0.4148 | F1: 0.5024 | Precision: 0.4796 | Recall: 0.5539
✅ Model saved.

Epoch 34/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.0900 | Val Loss: 0.1481
Global -> IoU: 0.4175 | F1: 0.4822 | Precision: 0.4707 | Recall: 0.5162
No improvement.

Epoch 35/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.0839 | Val Loss: 0.1043
Global -> IoU: 0.4126 | F1: 0.4990 | Precision: 0.4829 | Recall: 0.5520
✅ Model saved.

Epoch 36/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.1686 | Val Loss: 0.2552
Global -> IoU: 0.3036 | F1: 0.3741 | Precision: 0.3645 | Recall: 0.4325
No improvement.

Epoch 37/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.1219 | Val Loss: 0.1739
Global -> IoU: 0.3485 | F1: 0.4327 | Precision: 0.4049 | Recall: 0.4978
No improvement.

Epoch 38/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.0983 | Val Loss: 0.1213
Global -> IoU: 0.3643 | F1: 0.4702 | Precision: 0.4403 | Recall: 0.5447
No improvement.

Epoch 39/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.0857 | Val Loss: 0.1121
Global -> IoU: 0.3887 | F1: 0.4913 | Precision: 0.4854 | Recall: 0.5374
No improvement.

Epoch 40/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.73s/it]

Train Loss: 0.0934 | Val Loss: 0.1232
Global -> IoU: 0.3933 | F1: 0.4885 | Precision: 0.4732 | Recall: 0.5321
No improvement.

Epoch 41/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.0803 | Val Loss: 0.0935
Global -> IoU: 0.4152 | F1: 0.5168 | Precision: 0.5048 | Recall: 0.5559
✅ Model saved.

Epoch 42/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.73s/it]

Train Loss: 0.0806 | Val Loss: 0.1023
Global -> IoU: 0.4178 | F1: 0.5080 | Precision: 0.4837 | Recall: 0.5657
No improvement.

Epoch 43/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.28s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.0860 | Val Loss: 0.3067
Global -> IoU: 0.4013 | F1: 0.5162 | Precision: 0.4921 | Recall: 0.5779
No improvement.

Epoch 44/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.0990 | Val Loss: 0.1824
Global -> IoU: 0.3508 | F1: 0.4626 | Precision: 0.4767 | Recall: 0.4805
No improvement.

Epoch 45/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.75s/it]

Train Loss: 0.1052 | Val Loss: 0.2463
Global -> IoU: 0.2825 | F1: 0.4005 | Precision: 0.4500 | Recall: 0.4324
No improvement.

Epoch 46/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.73s/it]

Train Loss: 0.1264 | Val Loss: 0.1938
Global -> IoU: 0.3479 | F1: 0.4383 | Precision: 0.4483 | Recall: 0.5026
No improvement.

Epoch 47/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.0887 | Val Loss: 0.1057
Global -> IoU: 0.3743 | F1: 0.4827 | Precision: 0.4580 | Recall: 0.5681
No improvement.

Epoch 48/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.0731 | Val Loss: 0.0998
Global -> IoU: 0.4309 | F1: 0.5328 | Precision: 0.5116 | Recall: 0.5755
No improvement.

Epoch 49/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.0735 | Val Loss: 0.1008
Global -> IoU: 0.4166 | F1: 0.5277 | Precision: 0.4971 | Recall: 0.5837
No improvement.

Epoch 50/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:34<00:00,  3.27s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.74s/it]

Train Loss: 0.1033 | Val Loss: 0.2053
Global -> IoU: 0.3021 | F1: 0.4123 | Precision: 0.3896 | Recall: 0.5124
No improvement.
