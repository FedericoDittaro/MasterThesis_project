Training set: 1797 immagini
Validation set: 385 immagini
Test set: 386 immagini
Conteggio pixel per classe: 100%|██████████████████████████████████████████████████| 1797/1797 [00:07<00:00, 254.82it/s]
Pixel per classe: [    42200 115363613    245824      5186       814    118857     72255
     13434      5310    197877    249757    296875    181268     91103
    390110    217388      6870     21528    247923]

Epoch 1/50
Training:  67%|████████████████████████████████████████████████▋                        | 38/57 [01:09<00:34,  1.82s/it]

Epoch 1/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.70s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.51s/it]
Train Loss: 2.5063 | Val Loss: 4.0296 | IoU: 0.0153 | F1: 0.0253 | Precision: 0.0612 | Recall: 0.0722
✅ Model saved.

Epoch 2/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.70s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.51s/it]
Train Loss: 2.0110 | Val Loss: 3.6288 | IoU: 0.0298 | F1: 0.0552 | Precision: 0.1361 | Recall: 0.1331
✅ Model saved.

Epoch 3/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.70s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.51s/it]
Train Loss: 1.7970 | Val Loss: 3.5704 | IoU: 0.0692 | F1: 0.0759 | Precision: 0.1305 | Recall: 0.1247
✅ Model saved.

Epoch 4/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.70s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.51s/it]
Train Loss: 1.5766 | Val Loss: 3.5902 | IoU: 0.0597 | F1: 0.0702 | Precision: 0.1493 | Recall: 0.1669
No improvement.

Epoch 5/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.70s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.51s/it]
Train Loss: 1.4000 | Val Loss: 3.3768 | IoU: 0.0812 | F1: 0.0906 | Precision: 0.1204 | Recall: 0.1826
✅ Model saved.

Epoch 6/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.70s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.51s/it]
Train Loss: 1.4238 | Val Loss: 2.9428 | IoU: 0.0784 | F1: 0.1086 | Precision: 0.1395 | Recall: 0.2210
✅ Model saved.

Epoch 7/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.70s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.51s/it]
Train Loss: 1.2158 | Val Loss: 2.7034 | IoU: 0.0881 | F1: 0.1176 | Precision: 0.1774 | Recall: 0.2353
✅ Model saved.

Epoch 8/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.51s/it]
Train Loss: 1.2672 | Val Loss: 2.8771 | IoU: 0.0790 | F1: 0.1045 | Precision: 0.1667 | Recall: 0.2951
No improvement.

Epoch 9/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.70s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 1.1768 | Val Loss: 2.5394 | IoU: 0.1219 | F1: 0.1957 | Precision: 0.1947 | Recall: 0.4130
✅ Model saved.

Epoch 10/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.70s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 1.1192 | Val Loss: 2.5423 | IoU: 0.1323 | F1: 0.2185 | Precision: 0.1978 | Recall: 0.4517
No improvement.

Epoch 11/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.70s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.51s/it]
Train Loss: 1.0219 | Val Loss: 2.5949 | IoU: 0.1140 | F1: 0.1992 | Precision: 0.2157 | Recall: 0.3658
No improvement.

Epoch 12/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.70s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.51s/it]
Train Loss: 1.0908 | Val Loss: 2.7154 | IoU: 0.1093 | F1: 0.1751 | Precision: 0.1606 | Recall: 0.3706
No improvement.

Epoch 13/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.51s/it]
Train Loss: 1.0300 | Val Loss: 2.6875 | IoU: 0.1331 | F1: 0.2215 | Precision: 0.2195 | Recall: 0.4747
No improvement.

Epoch 14/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.9563 | Val Loss: 2.7336 | IoU: 0.1367 | F1: 0.2281 | Precision: 0.1911 | Recall: 0.5353
No improvement.

Epoch 15/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.9181 | Val Loss: 2.8975 | IoU: 0.1405 | F1: 0.2383 | Precision: 0.2014 | Recall: 0.5386
No improvement.

Epoch 16/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.51s/it]
Train Loss: 0.9052 | Val Loss: 2.8303 | IoU: 0.1311 | F1: 0.2212 | Precision: 0.1856 | Recall: 0.5485
No improvement.

Epoch 17/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.70s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.51s/it]
Train Loss: 0.7612 | Val Loss: 3.2082 | IoU: 0.1414 | F1: 0.2476 | Precision: 0.2069 | Recall: 0.5460
No improvement.

Epoch 18/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.51s/it]
Train Loss: 0.7040 | Val Loss: 2.9618 | IoU: 0.1217 | F1: 0.2173 | Precision: 0.1818 | Recall: 0.5410
No improvement.

Epoch 19/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.70s/it]
Validation:  85%|████████████████████████████████████████████████████████████           | 11/13 [00:18<00:03,  1.64s/it]
[34m[1mwandb[0m: [33mWARNING[0m Fatal error while uploading data. Some run data will not be synced, but it will still be written to disk. Use `wandb sync` at the end of the run to try uploading.
Conteggio pixel per classe:  29%|██████████████▌                                    | 513/1797 [00:02<00:05, 253.98it/s]
Conteggio pixel per classe: 100%|██████████████████████████████████████████████████| 1797/1797 [00:07<00:00, 254.75it/s]
Pixel per classe: [    42200 115363613    245824      5186       814    118857     72255
     13434      5310    197877    249757    296875    181268     91103
    390110    217388      6870     21528    247923]
Conteggio pixel per classe: 100%|██████████████████████████████████████████████████| 1797/1797 [00:07<00:00, 254.93it/s]
Pixel per classe: [    42200 115363613    245824      5186       814    118857     72255
     13434      5310    197877    249757    296875    181268     91103
    390110    217388      6870     21528    247923]
Conteggio per ogni classe: [    42200 115363613    245824      5186       814    118857     72255
     13434      5310    197877    249757    296875    181268     91103
    390110    217388      6870     21528    247923]
Conteggio pixel per classe: 100%|██████████████████████████████████████████████████| 1797/1797 [00:07<00:00, 254.94it/s]

✅ Classi uniche trovate nel training set: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]
📊 Pixel per classe:
Classe  0:      42200
Classe  1:  115363613
Classe  2:     245824
Classe  3:       5186
Classe  4:        814
Classe  5:     118857
Classe  6:      72255
Classe  7:      13434
Classe  8:       5310
Classe  9:     197877
Classe 10:     249757
Classe 11:     296875
Classe 12:     181268
Classe 13:      91103
Classe 14:     390110
Classe 15:     217388
Classe 16:       6870
Classe 17:      21528
Classe 18:     247923

⚖️ Pesi calcolati per CrossEntropyLoss:
Classe  0: Peso = 0.000024
Classe  1: Peso = 0.000000
Classe  2: Peso = 0.000004
Classe  3: Peso = 0.000193
Classe  4: Peso = 0.001229
Classe  5: Peso = 0.000008
Classe  6: Peso = 0.000014
Classe  7: Peso = 0.000074
Classe  8: Peso = 0.000188
Classe  9: Peso = 0.000005
Classe 10: Peso = 0.000004
Classe 11: Peso = 0.000003
Classe 12: Peso = 0.000006
Classe 13: Peso = 0.000011
Classe 14: Peso = 0.000003
Classe 15: Peso = 0.000005
Classe 16: Peso = 0.000146
Classe 17: Peso = 0.000046
Classe 18: Peso = 0.000004
