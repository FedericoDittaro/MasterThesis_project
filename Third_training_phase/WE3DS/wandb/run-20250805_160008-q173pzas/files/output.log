Training set: 1797 immagini
Validation set: 385 immagini
Test set: 386 immagini
Conteggio pixel per classe: 100%|██████████████████████████████████████████████████| 1797/1797 [00:07<00:00, 254.31it/s]

✅ Classi uniche trovate nel training set: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]
📊 Pixel per classe:
Classe  0:      42200
Classe  1:  115363613
Classe  2:     245824
Classe  3:       5186
Classe  4:        814
Classe  5:     118857
Classe  6:      72255
Classe  7:      13434
Classe  8:       5310
Classe  9:     197877
Classe 10:     249757
Classe 11:     296875
Classe 12:     181268
Classe 13:      91103
Classe 14:     390110
Classe 15:     217388
Classe 16:       6870
Classe 17:      21528
Classe 18:     247923

⚖️ Pesi calcolati per CrossEntropyLoss:
Classe  0: Peso = 0.000024
Classe  1: Peso = 0.000000
Classe  2: Peso = 0.000004
Classe  3: Peso = 0.000193
Classe  4: Peso = 0.001229
Classe  5: Peso = 0.000008
Classe  6: Peso = 0.000014
Classe  7: Peso = 0.000074
Classe  8: Peso = 0.000188
Classe  9: Peso = 0.000005
Classe 10: Peso = 0.000004
Classe 11: Peso = 0.000003
Classe 12: Peso = 0.000006
Classe 13: Peso = 0.000011
Classe 14: Peso = 0.000003
Classe 15: Peso = 0.000005
Classe 16: Peso = 0.000146
Classe 17: Peso = 0.000046
Classe 18: Peso = 0.000004

Epoch 1/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:38<00:00,  1.73s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 2.6952 | Val Loss: 3.0414 | IoU: 0.0064 | F1: 0.0126 | Precision: 0.0599 | Recall: 0.0705
✅ Model saved.

Epoch 2/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 2.0991 | Val Loss: 3.0403 | IoU: 0.0618 | F1: 0.0702 | Precision: 0.0826 | Recall: 0.1085
✅ Model saved.

Epoch 3/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 1.8268 | Val Loss: 2.8185 | IoU: 0.0592 | F1: 0.0720 | Precision: 0.0787 | Recall: 0.1565
✅ Model saved.

Epoch 4/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 1.6444 | Val Loss: 3.1495 | IoU: 0.0416 | F1: 0.0515 | Precision: 0.0768 | Recall: 0.1130
No improvement.

Epoch 5/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 1.5115 | Val Loss: 4.5199 | IoU: 0.0485 | F1: 0.0809 | Precision: 0.0992 | Recall: 0.1254
No improvement.

Epoch 6/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 1.3506 | Val Loss: 3.5266 | IoU: 0.0720 | F1: 0.0758 | Precision: 0.1247 | Recall: 0.1905
No improvement.

Epoch 7/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 1.2679 | Val Loss: 2.5916 | IoU: 0.0797 | F1: 0.1198 | Precision: 0.1381 | Recall: 0.2976
✅ Model saved.

Epoch 8/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 1.1639 | Val Loss: 2.9595 | IoU: 0.0926 | F1: 0.1199 | Precision: 0.1559 | Recall: 0.2388
No improvement.

Epoch 9/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 1.1929 | Val Loss: 2.7816 | IoU: 0.1024 | F1: 0.1593 | Precision: 0.1735 | Recall: 0.3700
No improvement.

Epoch 10/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 1.0748 | Val Loss: 2.5058 | IoU: 0.1282 | F1: 0.1986 | Precision: 0.2043 | Recall: 0.3926
✅ Model saved.

Epoch 11/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.9639 | Val Loss: 2.4160 | IoU: 0.1629 | F1: 0.2502 | Precision: 0.2448 | Recall: 0.4653
✅ Model saved.

Epoch 12/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.9498 | Val Loss: 2.5122 | IoU: 0.1227 | F1: 0.1904 | Precision: 0.1882 | Recall: 0.4464
No improvement.

Epoch 13/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 1.2127 | Val Loss: 2.7936 | IoU: 0.0782 | F1: 0.1141 | Precision: 0.1450 | Recall: 0.2965
No improvement.

Epoch 14/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 1.1443 | Val Loss: 2.3345 | IoU: 0.1111 | F1: 0.1969 | Precision: 0.2208 | Recall: 0.3908
✅ Model saved.

Epoch 15/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.8939 | Val Loss: 2.1270 | IoU: 0.1587 | F1: 0.2556 | Precision: 0.2142 | Recall: 0.5417
✅ Model saved.

Epoch 16/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.7781 | Val Loss: 2.3315 | IoU: 0.1472 | F1: 0.2262 | Precision: 0.2206 | Recall: 0.4803
No improvement.

Epoch 17/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.7745 | Val Loss: 2.6021 | IoU: 0.1287 | F1: 0.2134 | Precision: 0.1948 | Recall: 0.4826
No improvement.

Epoch 18/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.7575 | Val Loss: 2.1365 | IoU: 0.1641 | F1: 0.2682 | Precision: 0.2297 | Recall: 0.5418
No improvement.

Epoch 19/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.6464 | Val Loss: 2.1171 | IoU: 0.1638 | F1: 0.2786 | Precision: 0.2315 | Recall: 0.5836
✅ Model saved.

Epoch 20/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.6728 | Val Loss: 2.3729 | IoU: 0.1506 | F1: 0.2534 | Precision: 0.2071 | Recall: 0.5656
No improvement.

Epoch 21/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.53s/it]
Train Loss: 0.6738 | Val Loss: 1.9689 | IoU: 0.1661 | F1: 0.2824 | Precision: 0.2360 | Recall: 0.6015
✅ Model saved.

Epoch 22/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.5524 | Val Loss: 2.1844 | IoU: 0.1595 | F1: 0.2706 | Precision: 0.2116 | Recall: 0.6088
No improvement.

Epoch 23/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.5538 | Val Loss: 2.3570 | IoU: 0.1513 | F1: 0.2436 | Precision: 0.2041 | Recall: 0.5664
No improvement.

Epoch 24/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.6316 | Val Loss: 2.0294 | IoU: 0.1634 | F1: 0.2793 | Precision: 0.2316 | Recall: 0.5971
No improvement.

Epoch 25/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.4798 | Val Loss: 2.0977 | IoU: 0.1805 | F1: 0.2909 | Precision: 0.2431 | Recall: 0.6297
No improvement.

Epoch 26/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.4263 | Val Loss: 2.0601 | IoU: 0.1761 | F1: 0.2885 | Precision: 0.2363 | Recall: 0.6345
No improvement.

Epoch 27/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.4769 | Val Loss: 1.8768 | IoU: 0.2212 | F1: 0.3438 | Precision: 0.2785 | Recall: 0.6402
✅ Model saved.

Epoch 28/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.53s/it]
Train Loss: 0.5118 | Val Loss: 2.0344 | IoU: 0.1751 | F1: 0.2828 | Precision: 0.2396 | Recall: 0.6241
No improvement.

Epoch 29/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.4741 | Val Loss: 2.2542 | IoU: 0.1868 | F1: 0.2959 | Precision: 0.2516 | Recall: 0.6052
No improvement.

Epoch 30/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.5552 | Val Loss: 2.1321 | IoU: 0.2068 | F1: 0.3105 | Precision: 0.2617 | Recall: 0.6333
No improvement.

Epoch 31/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.5311 | Val Loss: 1.9166 | IoU: 0.2036 | F1: 0.3292 | Precision: 0.2878 | Recall: 0.6011
No improvement.

Epoch 32/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.4654 | Val Loss: 2.3982 | IoU: 0.2010 | F1: 0.3065 | Precision: 0.2484 | Recall: 0.6244
No improvement.

Epoch 33/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.4290 | Val Loss: 2.2592 | IoU: 0.2120 | F1: 0.3282 | Precision: 0.2683 | Recall: 0.6294
No improvement.

Epoch 34/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.4870 | Val Loss: 2.0321 | IoU: 0.1792 | F1: 0.2883 | Precision: 0.2292 | Recall: 0.6684
No improvement.

Epoch 35/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.4394 | Val Loss: 2.2201 | IoU: 0.1891 | F1: 0.2989 | Precision: 0.2377 | Recall: 0.6675
No improvement.

Epoch 36/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.6315 | Val Loss: 2.1152 | IoU: 0.1731 | F1: 0.2704 | Precision: 0.2276 | Recall: 0.6211
No improvement.

Epoch 37/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.4267 | Val Loss: 2.1549 | IoU: 0.1866 | F1: 0.2903 | Precision: 0.2386 | Recall: 0.6438
No improvement.

Epoch 38/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.4919 | Val Loss: 2.3258 | IoU: 0.1530 | F1: 0.2453 | Precision: 0.2155 | Recall: 0.5798
No improvement.

Epoch 39/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.3894 | Val Loss: 1.9358 | IoU: 0.2035 | F1: 0.3274 | Precision: 0.2635 | Recall: 0.6709
No improvement.

Epoch 40/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.5119 | Val Loss: 2.2803 | IoU: 0.1589 | F1: 0.2682 | Precision: 0.2252 | Recall: 0.5949
No improvement.

Epoch 41/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.5902 | Val Loss: 2.2869 | IoU: 0.1709 | F1: 0.2984 | Precision: 0.2337 | Recall: 0.6291
No improvement.

Epoch 42/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.5976 | Val Loss: 2.8311 | IoU: 0.0937 | F1: 0.1714 | Precision: 0.1641 | Recall: 0.5251
No improvement.

Epoch 43/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.4129 | Val Loss: 2.3573 | IoU: 0.1730 | F1: 0.2858 | Precision: 0.2255 | Recall: 0.6518
No improvement.

Epoch 44/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.4116 | Val Loss: 2.2273 | IoU: 0.2134 | F1: 0.3379 | Precision: 0.2752 | Recall: 0.6646
No improvement.

Epoch 45/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.4196 | Val Loss: 2.1949 | IoU: 0.2185 | F1: 0.3490 | Precision: 0.2906 | Recall: 0.6584
No improvement.

Epoch 46/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.3866 | Val Loss: 2.0939 | IoU: 0.2315 | F1: 0.3558 | Precision: 0.2903 | Recall: 0.6812
No improvement.

Epoch 47/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.3575 | Val Loss: 2.2592 | IoU: 0.2002 | F1: 0.3265 | Precision: 0.2567 | Recall: 0.6718
No improvement.

Epoch 48/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.2991 | Val Loss: 2.2512 | IoU: 0.2238 | F1: 0.3340 | Precision: 0.2778 | Recall: 0.6768
No improvement.

Epoch 49/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.2937 | Val Loss: 2.4988 | IoU: 0.2163 | F1: 0.3341 | Precision: 0.2789 | Recall: 0.6505
No improvement.

Epoch 50/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 57/57 [01:37<00:00,  1.71s/it]
Validation: 100%|███████████████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.52s/it]
Train Loss: 0.3683 | Val Loss: 2.2297 | IoU: 0.2007 | F1: 0.3254 | Precision: 0.2554 | Recall: 0.6773
No improvement.
