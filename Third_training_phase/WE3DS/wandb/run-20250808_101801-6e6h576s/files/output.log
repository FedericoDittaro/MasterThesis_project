Training set: 1797 immagini
Validation set: 385 immagini
Test set: 386 immagini
Conteggio pixel per classe: 100%|██████████████████████████████████████████████████| 1797/1797 [00:07<00:00, 253.95it/s]

✅ Classi uniche trovate nel training set: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]
📊 Pixel per classe:
Classe  0:      42200
Classe  1:  115363613
Classe  2:     245824
Classe  3:       5186
Classe  4:        814
Classe  5:     118857
Classe  6:      72255
Classe  7:      13434
Classe  8:       5310
Classe  9:     197877
Classe 10:     249757
Classe 11:     296875
Classe 12:     181268
Classe 13:      91103
Classe 14:     390110
Classe 15:     217388
Classe 16:       6870
Classe 17:      21528
Classe 18:     247923

⚖️ Pesi calcolati per CrossEntropyLoss (log balanced):
Classe  0: Peso = 7.934412
Classe  1: Peso = 0.703515
Classe  2: Peso = 6.173943
Classe  3: Peso = 10.030555
Classe  4: Peso = 11.882275
Classe  5: Peso = 6.899561
Classe  6: Peso = 7.396885
Classe  7: Peso = 9.078799
Classe  8: Peso = 10.006927
Classe  9: Peso = 6.390507
Classe 10: Peso = 6.158104
Classe 11: Peso = 5.985680
Classe 12: Peso = 6.478035
Classe 13: Peso = 7.165256
Classe 14: Peso = 5.713352
Classe 15: Peso = 6.296634
Classe 16: Peso = 9.749368
Classe 17: Peso = 8.607302
Classe 18: Peso = 6.165458

Epoch 1/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:38<00:00,  3.39s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 2.1156 | Val Loss: 1.0265 | IoU: 0.1358 | F1: 0.0809 | Precision: 0.0773 | Recall: 0.0858
✅ Model saved.

Epoch 2/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.6727 | Val Loss: 1.0294 | IoU: 0.1260 | F1: 0.0643 | Precision: 0.1055 | Recall: 0.0621
No improvement.

Epoch 3/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.4280 | Val Loss: 1.1604 | IoU: 0.1234 | F1: 0.0586 | Precision: 0.1163 | Recall: 0.0590
No improvement.

Epoch 4/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.81s/it]
Train Loss: 0.3594 | Val Loss: 1.2151 | IoU: 0.1232 | F1: 0.0582 | Precision: 0.0575 | Recall: 0.0588
No improvement.

Epoch 5/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.81s/it]
Train Loss: 0.3244 | Val Loss: 1.2270 | IoU: 0.1304 | F1: 0.0735 | Precision: 0.1125 | Recall: 0.0677
No improvement.

Epoch 6/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.35s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.3003 | Val Loss: 1.2167 | IoU: 0.1413 | F1: 0.0884 | Precision: 0.0991 | Recall: 0.0826
No improvement.

Epoch 7/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.2896 | Val Loss: 1.2522 | IoU: 0.1423 | F1: 0.0898 | Precision: 0.0981 | Recall: 0.0847
No improvement.

Epoch 8/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.2520 | Val Loss: 1.1839 | IoU: 0.1392 | F1: 0.0859 | Precision: 0.1236 | Recall: 0.0912
No improvement.

Epoch 9/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.81s/it]
Train Loss: 0.2295 | Val Loss: 1.2870 | IoU: 0.1328 | F1: 0.0787 | Precision: 0.1682 | Recall: 0.0702
No improvement.

Epoch 10/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.2194 | Val Loss: 1.2647 | IoU: 0.1304 | F1: 0.0735 | Precision: 0.2980 | Recall: 0.0676
No improvement.

Epoch 11/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.1996 | Val Loss: 1.1548 | IoU: 0.1397 | F1: 0.0954 | Precision: 0.1772 | Recall: 0.0868
No improvement.

Epoch 12/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.81s/it]
Train Loss: 0.1909 | Val Loss: 1.0048 | IoU: 0.1471 | F1: 0.1156 | Precision: 0.2689 | Recall: 0.0994
✅ Model saved.

Epoch 13/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.1805 | Val Loss: 1.0548 | IoU: 0.1637 | F1: 0.1321 | Precision: 0.2563 | Recall: 0.1273
No improvement.

Epoch 14/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.1842 | Val Loss: 0.9095 | IoU: 0.1640 | F1: 0.1336 | Precision: 0.2940 | Recall: 0.1269
✅ Model saved.

Epoch 15/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.81s/it]
Train Loss: 0.1897 | Val Loss: 0.6924 | IoU: 0.2176 | F1: 0.1593 | Precision: 0.4350 | Recall: 0.1318
✅ Model saved.

Epoch 16/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.1659 | Val Loss: 0.5991 | IoU: 0.2411 | F1: 0.2438 | Precision: 0.4824 | Recall: 0.2078
✅ Model saved.

Epoch 17/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.81s/it]
Train Loss: 0.1597 | Val Loss: 0.4712 | IoU: 0.2739 | F1: 0.2818 | Precision: 0.4671 | Recall: 0.2504
✅ Model saved.

Epoch 18/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.1600 | Val Loss: 0.3994 | IoU: 0.2727 | F1: 0.3493 | Precision: 0.4496 | Recall: 0.3316
✅ Model saved.

Epoch 19/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.83s/it]
Train Loss: 0.1625 | Val Loss: 0.2924 | IoU: 0.3330 | F1: 0.4076 | Precision: 0.4631 | Recall: 0.4057
✅ Model saved.

Epoch 20/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.1365 | Val Loss: 0.2323 | IoU: 0.4365 | F1: 0.4641 | Precision: 0.4959 | Recall: 0.4520
✅ Model saved.

Epoch 21/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.1421 | Val Loss: 0.2510 | IoU: 0.4129 | F1: 0.4223 | Precision: 0.4467 | Recall: 0.4425
No improvement.

Epoch 22/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.1612 | Val Loss: 0.4394 | IoU: 0.3102 | F1: 0.4239 | Precision: 0.4340 | Recall: 0.4455
No improvement.

Epoch 23/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.1405 | Val Loss: 0.4245 | IoU: 0.3397 | F1: 0.4436 | Precision: 0.4490 | Recall: 0.4828
No improvement.

Epoch 24/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.1431 | Val Loss: 0.5712 | IoU: 0.3800 | F1: 0.4728 | Precision: 0.4550 | Recall: 0.5129
No improvement.

Epoch 25/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.1333 | Val Loss: 0.2645 | IoU: 0.3747 | F1: 0.4303 | Precision: 0.4324 | Recall: 0.4518
No improvement.

Epoch 26/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.1331 | Val Loss: 0.1715 | IoU: 0.4778 | F1: 0.4943 | Precision: 0.4853 | Recall: 0.5357
✅ Model saved.

Epoch 27/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.1315 | Val Loss: 0.1672 | IoU: 0.4675 | F1: 0.4670 | Precision: 0.4552 | Recall: 0.5117
✅ Model saved.

Epoch 28/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.1091 | Val Loss: 0.1392 | IoU: 0.5083 | F1: 0.5261 | Precision: 0.5419 | Recall: 0.5631
✅ Model saved.

Epoch 29/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.81s/it]
Train Loss: 0.0981 | Val Loss: 0.1229 | IoU: 0.5167 | F1: 0.5300 | Precision: 0.5060 | Recall: 0.5926
✅ Model saved.

Epoch 30/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.81s/it]
Train Loss: 0.0967 | Val Loss: 0.1341 | IoU: 0.5279 | F1: 0.5096 | Precision: 0.4925 | Recall: 0.5454
No improvement.

Epoch 31/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.81s/it]
Train Loss: 0.1010 | Val Loss: 0.1236 | IoU: 0.5392 | F1: 0.5222 | Precision: 0.5071 | Recall: 0.5603
No improvement.

Epoch 32/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.0924 | Val Loss: 0.1151 | IoU: 0.5404 | F1: 0.5255 | Precision: 0.4928 | Recall: 0.5792
✅ Model saved.

Epoch 33/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.1261 | Val Loss: 0.1364 | IoU: 0.5135 | F1: 0.5123 | Precision: 0.4886 | Recall: 0.5597
No improvement.

Epoch 34/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.81s/it]
Train Loss: 0.1310 | Val Loss: 0.1624 | IoU: 0.4827 | F1: 0.4791 | Precision: 0.4481 | Recall: 0.5517
No improvement.

Epoch 35/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.1284 | Val Loss: 0.2339 | IoU: 0.4062 | F1: 0.4899 | Precision: 0.4635 | Recall: 0.5440
No improvement.

Epoch 36/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.81s/it]
Train Loss: 0.1442 | Val Loss: 0.1694 | IoU: 0.3997 | F1: 0.4191 | Precision: 0.4123 | Recall: 0.4776
No improvement.

Epoch 37/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.1133 | Val Loss: 0.1425 | IoU: 0.5033 | F1: 0.4923 | Precision: 0.4781 | Recall: 0.5232
No improvement.

Epoch 38/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.81s/it]
Train Loss: 0.0915 | Val Loss: 0.1193 | IoU: 0.5196 | F1: 0.4937 | Precision: 0.4535 | Recall: 0.5662
No improvement.

Epoch 39/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.81s/it]
Train Loss: 0.0879 | Val Loss: 0.1200 | IoU: 0.5433 | F1: 0.5459 | Precision: 0.5091 | Recall: 0.6062
No improvement.

Epoch 40/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.0898 | Val Loss: 0.1759 | IoU: 0.5069 | F1: 0.5116 | Precision: 0.4810 | Recall: 0.5702
No improvement.

Epoch 41/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.0835 | Val Loss: 0.1305 | IoU: 0.5222 | F1: 0.5395 | Precision: 0.5086 | Recall: 0.5919
No improvement.

Epoch 42/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.81s/it]
Train Loss: 0.1034 | Val Loss: 0.1786 | IoU: 0.4779 | F1: 0.4833 | Precision: 0.4527 | Recall: 0.5453
No improvement.

Epoch 43/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.0887 | Val Loss: 0.1285 | IoU: 0.5037 | F1: 0.5011 | Precision: 0.4623 | Recall: 0.5754
No improvement.

Epoch 44/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.81s/it]
Train Loss: 0.0775 | Val Loss: 0.1426 | IoU: 0.4975 | F1: 0.4997 | Precision: 0.4795 | Recall: 0.5462
No improvement.

Epoch 45/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.0693 | Val Loss: 0.5075 | IoU: 0.3644 | F1: 0.4563 | Precision: 0.4789 | Recall: 0.4652
No improvement.

Epoch 46/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.0733 | Val Loss: 0.2139 | IoU: 0.4429 | F1: 0.5441 | Precision: 0.5324 | Recall: 0.5683
No improvement.

Epoch 47/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.83s/it]
Train Loss: 0.0723 | Val Loss: 0.1708 | IoU: 0.5052 | F1: 0.5062 | Precision: 0.4854 | Recall: 0.5610
No improvement.

Epoch 48/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.0747 | Val Loss: 0.1039 | IoU: 0.5483 | F1: 0.5276 | Precision: 0.4930 | Recall: 0.5794
✅ Model saved.

Epoch 49/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.81s/it]
Train Loss: 0.0656 | Val Loss: 0.1317 | IoU: 0.5431 | F1: 0.5276 | Precision: 0.4903 | Recall: 0.5850
No improvement.

Epoch 50/50
Training: 100%|█████████████████████████████████████████████████████████████████████████| 29/29 [01:37<00:00,  3.36s/it]
Validation: 100%|█████████████████████████████████████████████████████████████████████████| 7/7 [00:19<00:00,  2.82s/it]
Train Loss: 0.0710 | Val Loss: 0.1247 | IoU: 0.5432 | F1: 0.5322 | Precision: 0.5070 | Recall: 0.5686
No improvement.
